<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sheet Cards</title>
    <script src="https://cdnjs.cloudflare.com"></script>
    <style>
        body { font-family: sans-serif; background: #f4f4f9; padding: 10px; }
        .filters { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
        select { padding: 8px; border-radius: 5px; border: 1px solid #ccc; flex: 1; min-width: 120px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; }
        .card { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .card h3 { margin-top: 0; color: #333; }
        .tag { display: inline-block; background: #e0e0e0; padding: 2px 8px; border-radius: 4px; font-size: 0.8em; margin-right: 5px; }
        .price { font-weight: bold; color: green; }
        .rating { color: #f39c12; }
        a { display: block; margin-top: 10px; color: #007bff; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>

    <div class="filters">
        <select id="filterRegion"><option value="">All Regions</option></select>
        <select id="filterCategory"><option value="">All Categories</option></select>
    </div>

    <div id="cardGrid" class="grid">Loading items...</div>

    <script>
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRNfKG3v-7ATgwAUWo-4P_ASP-_nEL0Azv1TWTRMoPwbIYhWNTsNMDaso7kF7t2jh27McbUaMu6hdQs/pub?output=csv';
        let allData = [];

        function init() {
            Papa.parse(SHEET_URL, {
                download: true,
                header: true,
                complete: function(results) {
                    allData = results.data;
                    populateFilters(allData);
                    renderCards(allData);
                }
            });
        }

        function populateFilters(data) {
            const regions = [...new Set(data.map(i => i.region).filter(Boolean))];
            const categories = [...new Set(data.map(i => i.category).filter(Boolean))];
            
            const regSel = document.getElementById('filterRegion');
            const catSel = document.getElementById('filterCategory');

            regions.forEach(r => regSel.innerHTML += `<option value="${r}">${r}</option>`);
            categories.forEach(c => catSel.innerHTML += `<option value="${c}">${c}</option>`);

            [regSel, catSel].forEach(s => s.addEventListener('change', filterData));
        }

        function filterData() {
            const reg = document.getElementById('filterRegion').value;
            const cat = document.getElementById('filterCategory').value;

            const filtered = allData.filter(item => {
                return (!reg || item.region === reg) && (!cat || item.category === cat);
            });
            renderCards(filtered);
        }

        function renderCards(data) {
            const grid = document.getElementById('cardGrid');
            grid.innerHTML = data.map(item => `
                <div class="card">
                    <h3>${item.name}</h3>
                    <div><span class="tag">${item.region}</span><span class="tag">${item.category}</span></div>
                    <p class="price">${item.pricing}</p>
                    <p class="rating">Rating: ${item.rating} ★</p>
                    <a href="${item.link}" target="_blank">View Details →</a>
                </div>
            `).join('');
        }

        init();
    </script>
</body>
</html>
