<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Records List</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #f2f2f2; font-weight: bold; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        a { color: #1a73e8; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .loading { text-align: center; padding: 40px; font-style: italic; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Records from Google Sheets</h1>
    <div id="loading" class="loading">Loading records...</div>
    <div id="error" class="error" style="display: none;"></div>
    <table id="recordsTable" style="display: none;">
        <thead id="tableHead"></thead>
        <tbody id="tableBody"></tbody>
    </table>

    <script>
        async function loadCSV() {
            const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRNfKG3v-7ATgwAUWo-4P_ASP-_nEL0Azv1TWTRMoPwbIYhWNTsNMDaso7kF7t2jh27McbUaMu6hdQs/pub?output=csv'; // Replace with your Google Sheets CSV URL
            try {
                const response = await fetch(csvUrl);
                if (!response.ok) throw new Error('Failed to fetch CSV');
                const csvText = await response.text();
                const records = parseCSV(csvText);
                renderTable(records);
            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').textContent = `Error: ${error.message}`;
                document.getElementById('error').style.display = 'block';
            }
        }

        function parseCSV(text) {
            const lines = text.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            const rows = lines.slice(1).map(line => {
                const values = [];
                let current = '';
                let inQuotes = false;
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    if (char === '"') inQuotes = !inQuotes;
                    else if (char === ',' && !inQuotes) {
                        values.push(current.trim());
                        current = '';
                    } else current += char;
                }
                values.push(current.trim());
                return values.map(v => v.replace(/"/g, ''));
            }).filter(row => row.some(cell => cell)); // Skip empty rows
            return { headers, rows };
        }

        function renderTable({ headers, rows }) {
            const tableHead = document.getElementById('tableHead');
            const tableBody = document.getElementById('tableBody');
            const table = document.getElementById('recordsTable');
            const loading = document.getElementById('loading');

            // Headers
            tableHead.innerHTML = `<tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr>`;

            // Rows (handle Google Maps links: make clickable if URL-like)
            tableBody.innerHTML = rows.map(row => {
                return `<tr>${row.map((cell, i) => {
                    if (headers[i] === 'google maps link' && cell.includes('http')) {
                        return `<td><a href="${cell}" target="_blank">${cell}</a></td>`;
                    }
                    return `<td>${cell}</td>`;
                }).join('')}</tr>`;
            }).join('');

            loading.style.display = 'none';
            table.style.display = 'table';
        }

        loadCSV(); // Auto-load on page ready
    </script>
</body>
</html>
